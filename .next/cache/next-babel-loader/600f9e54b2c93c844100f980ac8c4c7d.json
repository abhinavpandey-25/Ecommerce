{"ast":null,"code":"import jwt from 'jsonwebtoken';\n\nfunction Authenticated(icomponent) {\n  return (req, res) => {\n    const {\n      authorization\n    } = req.headers;\n\n    if (!authorization) {\n      return res.status(401).json({\n        error: \"you must logged in\"\n      });\n    }\n\n    try {\n      const {\n        userid\n      } = jwt.verify(authorization, process.env.JWT_SECRET);\n      console.log(userid);\n      req.userid = userid;\n      return icomponent(req, res);\n    } catch (error) {\n      console.log(error);\n      return res.status(401).json({\n        error: \"login please\"\n      });\n    }\n  };\n}\n\nexport default Authenticated;","map":null,"metadata":{},"sourceType":"module"}