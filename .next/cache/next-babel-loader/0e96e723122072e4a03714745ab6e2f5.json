{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useState, useEffect } from 'react';\nimport { parseCookies } from 'nookies';\nimport baseURL from '../helper/baseURL';\n\nfunction UserRoles() {\n  var _parseCookies = parseCookies(),\n      token = _parseCookies.token;\n\n  var _useState = useState([]),\n      user = _useState[0],\n      setUser = _useState[1];\n\n  useEffect(function () {\n    fetchUser();\n  }, []);\n\n  var fetchUser = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res, res2;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fetch(\"\".concat(baseURL, \"/api/users\"), {\n                headers: {\n                  \"Authorization\": token\n                }\n              });\n\n            case 2:\n              res = _context.sent;\n              _context.next = 5;\n              return res.json();\n\n            case 5:\n              res2 = _context.sent;\n              console.log(res2);\n              setUser(res2);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function fetchUser() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleRole = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id, role) {\n      var res, res2, updatedUser;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetch(\"\".concat(baseURL, \"/api/users\"), {\n                method: \"PUT\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  \"Authorization\": token\n                },\n                body: JSON.stringify({\n                  _id: id,\n                  role: role\n                })\n              });\n\n            case 2:\n              res = _context2.sent;\n              _context2.next = 5;\n              return res.json();\n\n            case 5:\n              res2 = _context2.sent;\n              console.log(res2); //map function returns an array\n\n              updatedUser = user.map(function (person) {\n                if (res2._id == person._id) {\n                  return res2;\n                } else {\n                  return person;\n                }\n              });\n              setUser(updatedUser);\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleRole(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsx(\"div\", {\n    children: /*#__PURE__*/_jsxs(\"table\", {\n      children: [/*#__PURE__*/_jsx(\"thead\", {\n        children: /*#__PURE__*/_jsxs(\"tr\", {\n          children: [/*#__PURE__*/_jsx(\"th\", {\n            children: \"Name\"\n          }), /*#__PURE__*/_jsx(\"th\", {\n            children: \"Email\"\n          }), /*#__PURE__*/_jsx(\"th\", {\n            children: \"Role\"\n          })]\n        })\n      }), /*#__PURE__*/_jsx(\"tbody\", {\n        children: user.map(function (item) {\n          return (\n            /*#__PURE__*/\n            //alt+shift+downkey is used to copy the current line to the next line\n            _jsxs(\"tr\", {\n              children: [/*#__PURE__*/_jsx(\"td\", {\n                children: item.name\n              }), /*#__PURE__*/_jsx(\"td\", {\n                children: item.email\n              }), /*#__PURE__*/_jsxs(\"td\", {\n                children: [item.role, /*#__PURE__*/_jsx(\"button\", {\n                  className: \"btn danger\",\n                  style: {\n                    marginLeft: \"20px\"\n                  },\n                  onClick: function onClick() {\n                    return handleRole(item._id, item.role);\n                  },\n                  children: \"Toggle role\"\n                })]\n              })]\n            }, item._id)\n          );\n        })\n      })]\n    })\n  });\n}\n\nexport default UserRoles;","map":null,"metadata":{},"sourceType":"module"}