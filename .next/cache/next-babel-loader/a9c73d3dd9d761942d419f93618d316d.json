{"ast":null,"code":"import jwt from 'jsonwebtoken';\n\nfunction Authenticated(icomponent) {\n  return (req, res) => {\n    const {\n      authorization\n    } = req.headers;\n\n    if (!authorization) {\n      return res.status(401).json({\n        error: \"you must logged in\"\n      });\n    }\n\n    try {\n      const {\n        userid\n      } = jwt.verify(authorization, process.env.JWT_SECRET);\n      console.log(userid);\n      req.userid = userid;\n      return icomponent(req, res);\n    } catch (error) {\n      console.log(error);\n      return res.status(401).json({\n        error: \"login please\"\n      });\n    }\n  };\n}\n\nexport default Authenticated;","map":{"version":3,"sources":["C:/Users/Lenovo/Desktop/ECommerce/mystore/helper/Authenticated.js"],"names":["jwt","Authenticated","icomponent","req","res","authorization","headers","status","json","error","userid","verify","process","env","JWT_SECRET","console","log"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,cAAhB;;AACA,SAASC,aAAT,CAAuBC,UAAvB,EAAkC;AAC7B,SAAO,CAACC,GAAD,EAAKC,GAAL,KAAW;AACf,UAAM;AAACC,MAAAA;AAAD,QAAgBF,GAAG,CAACG,OAA1B;;AACA,QAAG,CAACD,aAAJ,EAAkB;AACd,aAAOD,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,QAAAA,KAAK,EAAC;AAAP,OAArB,CAAP;AACH;;AACF,QAAI;AACK,YAAM;AAACC,QAAAA;AAAD,UAASV,GAAG,CAACW,MAAJ,CAAWN,aAAX,EAAyBO,OAAO,CAACC,GAAR,CAAYC,UAArC,CAAf;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYN,MAAZ;AACAP,MAAAA,GAAG,CAACO,MAAJ,GAAWA,MAAX;AACA,aAAOR,UAAU,CAACC,GAAD,EAAKC,GAAL,CAAjB;AACJ,KALL,CAMA,OAAOK,KAAP,EAAc;AACVM,MAAAA,OAAO,CAACC,GAAR,CAAYP,KAAZ;AACK,aAAQL,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,QAAAA,KAAK,EAAC;AAAP,OAArB,CAAR;AACH;AACR,GAfA;AAgBJ;;AACD,eAAeR,aAAf","sourcesContent":["import jwt from 'jsonwebtoken'\r\nfunction Authenticated(icomponent){\r\n     return (req,res)=>{\r\n        const {authorization}=req.headers;\r\n        if(!authorization){\r\n            return res.status(401).json({error:\"you must logged in\"})\r\n        }\r\n       try {\r\n                const {userid}=jwt.verify(authorization,process.env.JWT_SECRET);\r\n                console.log(userid);\r\n                req.userid=userid\r\n                return icomponent(req,res)\r\n           }\r\n       catch (error) {\r\n           console.log(error)\r\n                return  res.status(401).json({error:\"login please\"})\r\n            }\r\n    }\r\n}\r\nexport default Authenticated;\r\n"]},"metadata":{},"sourceType":"module"}