{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { model } from 'mongoose';\nimport { useRouter } from 'next/router';\nimport { useRef, useEffect, useState } from 'react';\nimport baseURL from '../../helper/baseURL';\nimport { parseCookies } from 'nookies';\n\nvar product = function product(props) {\n  var _useState = useState(1),\n      quantity = _useState[0],\n      setQuantity = _useState[1];\n\n  var router = useRouter();\n  var modalRef = useRef(null);\n  var cookies = parseCookies();\n  var user = cookies.user ? JSON.parse(cookies.user) : \"\";\n  useEffect(function () {\n    M.Modal.init(modalRef.current); //here modal agar triiger p work krana toh initialise karna padata h uske refrence se jo tiriger k bad display hoga\n  }, []);\n\n  if (router.isFallback) {\n    //agar use static props krte and and fallback true h then agar wo page already build nhi h toh server se fetch\n    //krenge jisme time lgta h toh tb tak ham loading a option dekha sakte h.\n    return /*#__PURE__*/_jsx(\"h1\", {\n      children: \"...Loading\"\n    });\n  } // console.log(props);\n\n\n  var getModal = function getModal() {\n    return /*#__PURE__*/_jsxs(\"div\", {\n      id: \"modal1\",\n      className: \"modal\",\n      ref: modalRef,\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: \"modal-content\",\n        children: [/*#__PURE__*/_jsx(\"h4\", {\n          children: \"Modal Header\"\n        }), /*#__PURE__*/_jsx(\"p\", {\n          children: \"Are u sure to delete this item\"\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"modal-footer\",\n        children: [/*#__PURE__*/_jsxs(\"button\", {\n          onClick: function onClick() {\n            return deleteProduct();\n          },\n          className: \"btn waves-effect waves-light  #d50000 red accent-4\",\n          style: {\n            margin: \"5px\"\n          },\n          children: [/*#__PURE__*/_jsx(\"b\", {\n            children: \"Delete\"\n          }), \" \", /*#__PURE__*/_jsx(\"i\", {\n            className: \"material-icons\",\n            children: \"delete\"\n          })]\n        }), /*#__PURE__*/_jsxs(\"button\", {\n          className: \"btn waves-effect waves-light #4a148c purple darken-4\",\n          style: {\n            margin: \"5px\"\n          },\n          children: [/*#__PURE__*/_jsx(\"b\", {\n            children: \"Cancel\"\n          }), \" \", /*#__PURE__*/_jsx(\"i\", {\n            className: \"material-icons\",\n            children: \"cancel\"\n          })]\n        })]\n      })]\n    });\n  };\n\n  var deleteProduct = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              console.log(\"del method\");\n              console.log(props.value._id);\n              fetch(\"\".concat(baseURL, \"/api/product/\").concat(props.value._id), {\n                method: \"DELETE\"\n              }).then(function (res) {\n                return res.json();\n              }).then(function (res2) {\n                return console.log(res2);\n              });\n              router.push('/');\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function deleteProduct() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var AddtoCart = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var res, res2;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetch(\"\".concat(baseURL, \"/api/cart\"), {\n                method: \"PUT\",\n                headers: {\n                  'Content-Type': \"application/json\",\n                  \"Authorization\": cookies.token\n                },\n                body: JSON.stringify({\n                  quantity: quantity,\n                  productId: props.value._id\n                })\n              });\n\n            case 2:\n              res = _context2.sent;\n              _context2.next = 5;\n              return res.json();\n\n            case 5:\n              res2 = _context2.sent;\n              console.log(res2);\n              M.toast({\n                html: res2.message,\n                classes: \"green\"\n              });\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function AddtoCart() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: \"container center-align \",\n    style: {\n      marginBottom: \"20px\"\n    },\n    children: [/*#__PURE__*/_jsx(\"h2\", {\n      children: props.value.name\n    }), /*#__PURE__*/_jsx(\"img\", {\n      src: props.value.mediaURL,\n      style: {\n        \"width\": \"35%\",\n        \"height\": \"400px\"\n      }\n    }), /*#__PURE__*/_jsx(\"b\", {\n      children: /*#__PURE__*/_jsxs(\"p\", {\n        children: [\"RS \", props.value.price]\n      })\n    }), /*#__PURE__*/_jsx(\"input\", {\n      type: \"number\",\n      style: {\n        width: \"50%\",\n        textAlign: \"center\"\n      },\n      min: \"1\",\n      placeholder: \"Quantity\",\n      value: quantity,\n      onChange: function onChange(e) {\n        return setQuantity(Number(e.target.value));\n      }\n    }), user ? /*#__PURE__*/_jsxs(\"button\", {\n      className: \" btn waves-effect waves-light \",\n      onClick: function onClick() {\n        return AddtoCart();\n      },\n      children: [\"Add \", /*#__PURE__*/_jsx(\"i\", {\n        className: \"material-icons\",\n        children: \"add\"\n      })]\n    }) : /*#__PURE__*/_jsx(\"button\", {\n      className: \" btn waves-effect waves-light \",\n      onClick: function onClick() {\n        return router.push('/login');\n      },\n      children: \"Login to Add\"\n    }), /*#__PURE__*/_jsx(\"p\", {\n      children: props.value.description\n    }), user.role != \"user\" && /*#__PURE__*/_jsxs(\"button\", {\n      \"data-target\": \"modal1\",\n      className: \" btn modal-trigger waves-effect waves-light  #d50000 red accent-4 \",\n      children: [/*#__PURE__*/_jsx(\"b\", {\n        children: \"Delete\"\n      }), \" \", /*#__PURE__*/_jsx(\"i\", {\n        className: \"material-icons\",\n        children: \"delete\"\n      })]\n    }) //if the user is an admin then only u should give the delete button otherwise no need for delete button\n    , getModal()]\n  });\n};\n\n// export async function getStaticProps(context) {\n//    //since by using serverside props it can work fine but when the traffic is more it can decrease its performance\n//    //since the page is static one so we can use getstatic props also for better performance.\n//    const id= context.params.id;\n//    const data=await fetch(`${baseURL}/api/product/${id}`).then(res=>res.json());\n//    //console.log(data);\n//    return{\n//        props:{\n//            value:data\n//        }\n//    }\n// }       \n//first getstatic paths will run during build to build the sattic page with the givven id only\n//baki agar fallback false h toh other pages k liye pagenot found ayga but agar fall back true h toh jo id exist nhi krti at\n//build time then network request jese hoga on getstatic props\n// export async function getStaticPaths() {\n//     return {\n//       paths: [\n//         { params: { id:\"5f977b791efe90be048d25af\"} } \n//         //lets say we have a largee number of products then what should we doo hame har static path ko build time par hi build \n//         //kar sakte h\n//       ],\n//       fallback: true \n//     };\n//   }\nexport var __N_SSP = true;\nexport default product;","map":null,"metadata":{},"sourceType":"module"}